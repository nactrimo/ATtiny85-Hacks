(netsh wlan show profiles | Select-String ":\s(.+)$").Matches.Groups[1].Value.Trim() | ForEach-Object { $name = $_; $profileDetails = netsh wlan show profile name="$name" key=clear; ($profileDetails | Select-String "Contenu de la cl√©\W+\:\s(.+)$").Matches.Groups[1].Value.Trim() | ForEach-Object { $pass = $_; [PSCustomObject]@{ PROFILE_NAME = $name; PASSWORD = $pass } } } | Format-Table -AutoSize | Out-File "$env:USERPROFILE\Desktop\Log.txt"
